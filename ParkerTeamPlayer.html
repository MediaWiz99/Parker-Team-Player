<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parker Team Player Survey - Discover Your Team Player Style</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            border-radius: 15px;
            color: white;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="%23ffffff15" stroke-width="1"/></pattern></defs><rect width="100" height="20" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
            border-radius: 15px;
        }

        .logo {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
            opacity: 0.9;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 1.3em;
            font-style: italic;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .instructions {
            background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .instructions h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.6em;
        }

        .student-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .input-group input {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .rating-scale {
            background: #f1c40f;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 5px 15px rgba(241, 196, 15, 0.2);
        }

        .rating-scale h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .scale-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .scale-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            font-weight: 600;
        }

        .question-container {
            margin-bottom: 35px;
            background: white;
            border-radius: 15px;
            border: 3px solid #ecf0f1;
            transition: all 0.3s ease;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        }

        .question-container:hover {
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(52, 152, 219, 0.15);
        }

        .question-header {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            padding: 20px 25px;
            position: relative;
        }

        .question-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .question-text {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .question-content {
            padding: 25px;
        }

        .ranking-instructions {
            background: linear-gradient(135deg, #e8f8f5, #d5f4e6);
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #27ae60;
        }

        .options {
            display: grid;
            gap: 12px;
        }

        .option {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 12px;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .option:hover {
            background: #e3f2fd;
            border-color: #2196f3;
            transform: translateX(8px) scale(1.02);
            box-shadow: 0 8px 25px rgba(33, 150, 243, 0.15);
        }

        .option.selected {
            transform: translateX(8px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            font-weight: 500;
        }

        .option.rank-1 {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border-color: #27ae60;
        }

        .option.rank-2 {
            background: linear-gradient(135deg, #3498db, #5dade2);
            color: white;
            border-color: #3498db;
        }

        .option.rank-3 {
            background: linear-gradient(135deg, #f39c12, #f5b041);
            color: white;
            border-color: #f39c12;
        }

        .option.rank-4 {
            background: linear-gradient(135deg, #e74c3c, #ec7063);
            color: white;
            border-color: #e74c3c;
        }

        .rank-indicator {
            min-width: 180px;
            text-align: center;
            margin-right: 15px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .option:not(.selected) .rank-indicator {
            background: rgba(52, 73, 94, 0.1);
            color: #7f8c8d;
            font-weight: normal;
        }

        .option-text {
            flex-grow: 1;
            line-height: 1.6;
            font-size: 1.05em;
        }

        .ranking-status {
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            border: 2px dashed #bdc3c7;
        }

        .status-message {
            font-size: 1.1em;
            font-weight: bold;
            color: #7f8c8d;
            transition: all 0.3s ease;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #ecf0f1;
            border-radius: 5px;
            margin: 25px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db 0%, #2980b9 100%);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 5px;
        }

        .controls {
            text-align: center;
            margin: 30px 0;
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 35px;
            font-size: 1.1em;
            font-weight: 600;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 8px;
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(52, 152, 219, 0.4);
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn.secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }

        .btn.success {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .btn.download {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .results {
            display: none;
            margin-top: 40px;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            border-radius: 15px;
            color: white;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .result-header {
            text-align: center;
            padding: 40px 30px;
            background: rgba(255,255,255,0.05);
        }

        .result-header h2 {
            font-size: 2.2em;
            margin-bottom: 15px;
        }

        .result-info {
            background: rgba(255,255,255,0.1);
            padding: 15px 25px;
            margin: 20px 0;
            border-radius: 10px;
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
        }

        .score-card {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 2px solid transparent;
        }

        .score-card:hover {
            transform: scale(1.05);
        }

        .score-card.primary {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            transform: scale(1.08);
            border-color: #f39c12;
        }

        .score-card.secondary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            border-color: #3498db;
        }

        .score-card h3 {
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .score-card .score {
            font-size: 2.5em;
            font-weight: bold;
            margin: 15px 0;
        }

        .interpretation {
            background: white;
            color: #2c3e50;
            padding: 40px;
            margin: 0;
            line-height: 1.8;
        }

        .interpretation h3 {
            color: #e74c3c;
            margin-bottom: 20px;
            font-size: 1.6em;
        }

        .interpretation h4 {
            color: #3498db;
            margin: 25px 0 15px 0;
            font-size: 1.3em;
        }

        .style-explanation {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #3498db;
        }

        .style-overview {
            background: #e8f6ff;
            padding: 30px;
            border-radius: 12px;
            margin: 25px 0;
            border: 2px solid #3498db;
        }

        .styles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .style-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid;
        }

        .style-card.contributor { border-left-color: #27ae60; }
        .style-card.collaborator { border-left-color: #3498db; }
        .style-card.communicator { border-left-color: #f39c12; }
        .style-card.challenger { border-left-color: #e74c3c; }

        .strengths-weaknesses {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 25px 0;
        }

        .strengths, .weaknesses {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
        }

        .strengths {
            border-left: 4px solid #27ae60;
        }

        .weaknesses {
            border-left: 4px solid #e74c3c;
        }

        .strengths h4, .weaknesses h4 {
            margin-top: 0;
        }

        .strengths ul, .weaknesses ul {
            list-style-type: none;
            padding-left: 0;
        }

        .strengths li::before {
            content: "✓";
            color: #27ae60;
            font-weight: bold;
            margin-right: 10px;
        }

        .weaknesses li::before {
            content: "⚠";
            color: #e74c3c;
            font-weight: bold;
            margin-right: 10px;
        }

        .hidden {
            display: none;
        }

        .pdf-fallback {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            color: #856404;
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }

            .student-info {
                grid-template-columns: 1fr;
            }

            .scale-items {
                grid-template-columns: 1fr;
            }

            .strengths-weaknesses {
                grid-template-columns: 1fr;
            }

            .styles-grid {
                grid-template-columns: 1fr;
            }

            .rank-indicator {
                min-width: 130px;
                font-size: 0.8em;
            }

            .option {
                padding: 12px 15px;
            }

            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">Glenn M. Parker Team Assessment</div>
            <h1>PARKER TEAM PLAYER SURVEY</h1>
            <div class="subtitle">Discover Your Team Player Style</div>
        </div>

        <div id="intro-section">
            <div class="instructions">
                <h2>Purpose</h2>
                <p>The Parker Team Player Survey will help you identify your style, assess your current strengths, and create a plan for increasing your effectiveness as a team player. Teams may use the survey to develop a profile of team strengths and discuss strategies for increasing team effectiveness.</p>
                
                <h2 style="margin-top: 25px;">Directions</h2>
                <p>Answer each item according to how you honestly feel you function now as a team member rather than how you used to be or how you would like to be. Keep in mind that this is a survey and, therefore, there are no right or wrong answers.</p>
                <p>You will be asked to complete 18 sentences. Each sentence has four possible endings. <strong>Simply click the statements in order of your preference</strong> - from most applicable to least applicable.</p>

                <div class="rating-scale">
                    <h3>How the Ranking Works</h3>
                    <div class="scale-items">
                        <div class="scale-item">1st Click = <strong>4 Points (Most Applicable)</strong></div>
                        <div class="scale-item">2nd Click = <strong>3 Points (Second Most)</strong></div>
                        <div class="scale-item">3rd Click = <strong>2 Points (Third Most)</strong></div>
                        <div class="scale-item">4th Click = <strong>1 Point (Least Applicable)</strong></div>
                    </div>
                </div>
                
                <p><strong>Important:</strong> You must rank all four options for each question. Click any ranked option to remove it and re-rank if needed.</p>
            </div>

            <!-- Four Team Player Styles Overview -->
            <div class="style-overview">
                <h2 style="text-align: center; color: #2c3e50; margin-bottom: 25px;">The Four Team Player Styles</h2>
                <div class="styles-grid">
                    <div class="style-card contributor">
                        <h4 style="color: #27ae60; margin-bottom: 10px;">CONTRIBUTOR - Task Oriented</h4>
                        <p>Provides technical expertise, data, and information. Focuses on task completion and high performance standards. Detail-oriented and dependable.</p>
                    </div>
                    <div class="style-card collaborator">
                        <h4 style="color: #3498db; margin-bottom: 10px;">COLLABORATOR - Goal Oriented</h4>
                        <p>Focuses on the big picture, mission, and long-term goals. Flexible and willing to work outside defined roles. Sees team vision as paramount.</p>
                    </div>
                    <div class="style-card communicator">
                        <h4 style="color: #f39c12; margin-bottom: 10px;">COMMUNICATOR - Process Oriented</h4>
                        <p>Facilitates team interactions and creates positive climate. Skilled listener who encourages participation and resolves conflicts.</p>
                    </div>
                    <div class="style-card challenger">
                        <h4 style="color: #e74c3c; margin-bottom: 10px;">CHALLENGER - Question Oriented</h4>
                        <p>Questions team goals, methods, and ethics. Willing to disagree and push for well-considered risks. Provides honest, candid feedback.</p>
                    </div>
                </div>
                <p style="text-align: center; margin-top: 20px; font-style: italic;">Most effective teams have a balance of all four styles. You will likely have one primary style with possible secondary characteristics.</p>
            </div>

            <div class="student-info">
                <div class="input-group">
                    <label for="studentName">Student Name:</label>
                    <input type="text" id="studentName" placeholder="Enter your full name" required>
                </div>
                <div class="input-group">
                    <label for="testDate">Date:</label>
                    <input type="date" id="testDate" required>
                </div>
            </div>

            <div class="controls">
                <button class="btn" onclick="startSurvey()">Start Survey</button>
            </div>
        </div>

        <div id="survey-section" class="hidden">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div id="questions-container">
                <!-- Questions will be populated here -->
            </div>

            <div class="controls">
                <button class="btn secondary" id="prevBtn" onclick="previousQuestion()" disabled>← Previous</button>
                <button class="btn" id="nextBtn" onclick="nextQuestion()">Next →</button>
                <button class="btn success hidden" id="submitBtn" onclick="calculateResults()">Calculate Results</button>
            </div>
        </div>

        <div id="results" class="results">
            <!-- Results will be populated here -->
        </div>

        <div class="controls hidden" id="downloadSection">
            <button class="btn download" onclick="generatePDF()">Download PDF Report</button>
            <button class="btn secondary" onclick="restartSurvey()">Take Survey Again</button>
            <button class="btn" onclick="openInNewWindow()">Open Results in New Window</button>
        </div>
    </div>

    <script>
        // Survey questions from Parker Team Player Survey
        const questions = [
            {
                id: 1,
                text: "During team meetings I usually",
                options: {
                    a: "Provide the team with technical data or information",
                    b: "Keep the team focused on our mission or goals",
                    c: "Make sure everyone is involved in the discussion", 
                    d: "Raise questions about our goals or methods"
                }
            },
            {
                id: 2,
                text: "In relating to the team leader I",
                options: {
                    a: "Suggest that our work be goal directed",
                    b: "Try to help him or her build a positive team climate",
                    c: "Am willing to disagree with him or her when necessary",
                    d: "Offer advice based on my area of expertise"
                }
            },
            {
                id: 3,
                text: "Under stress I sometimes",
                options: {
                    a: "Overuse humor and other tension-reducing devices",
                    b: "Am too direct in communicating with other team members",
                    c: "Lose patience with the need to get everyone involved in discussions",
                    d: "Complain about lack of progress toward our goals"
                }
            },
            {
                id: 4,
                text: "When conflicts arise on the team I usually",
                options: {
                    a: "Press for an honest discussion of the differences",
                    b: "Provide reasons why one side or the other is correct", 
                    c: "See the differences as a basis for a possible change in team direction",
                    d: "Try to break the tension with a supportive or humorous remark"
                }
            },
            {
                id: 5,
                text: "Other team members usually see me as",
                options: {
                    a: "Factual",
                    b: "Flexible",
                    c: "Encouraging",
                    d: "Candid"
                }
            },
            {
                id: 6,
                text: "At times I am",
                options: {
                    a: "Too results oriented",
                    b: "Too laid back",
                    c: "Self-righteous",
                    d: "Shortsighted"
                }
            },
            {
                id: 7,
                text: "When things go wrong on the team I usually",
                options: {
                    a: "Push for increased emphasis on listening, feedback, and participation",
                    b: "Press for a candid discussion of our problems",
                    c: "Work hard to provide more and better information",
                    d: "Suggest that we revisit our basic mission"
                }
            },
            {
                id: 8,
                text: "When necessary I am able to",
                options: {
                    a: "Question some aspect of the team's work",
                    b: "Push the team to set higher performance standards",
                    c: "Work outside my defined role or job area",
                    d: "Provide others with feedback on their behavior as team members"
                }
            },
            {
                id: 9,
                text: "Sometimes other team members see me as",
                options: {
                    a: "A perfectionist",
                    b: "Unwilling to reassess the team's mission or goals",
                    c: "Not serious about getting the real job done",
                    d: "A nitpicker"
                }
            },
            {
                id: 10,
                text: "I believe team problem solving requires",
                options: {
                    a: "Cooperation by all team members",
                    b: "High-level listening skills",
                    c: "A willingness to ask tough questions",
                    d: "Good, solid data"
                }
            },
            {
                id: 11,
                text: "When a new team is forming I usually",
                options: {
                    a: "Try to meet and get to know other team members",
                    b: "Ask pointed questions about our goals and methods",
                    c: "Want to know what is expected of me",
                    d: "Seek clarity about our basic mission"
                }
            },
            {
                id: 12,
                text: "At times I make other team members uncomfortable because they",
                options: {
                    a: "Are not able to be as assertive as I am",
                    b: "Don't live up to my standards of quality",
                    c: "Don't think about long-range issues",
                    d: "Don't care about how the team works together"
                }
            },
            {
                id: 13,
                text: "I believe the role of the team leader is to",
                options: {
                    a: "Ensure the efficient solution of business problems",
                    b: "Help the team establish long-range goals and short-term objectives",
                    c: "Create a participatory decision-making climate",
                    d: "Bring out diverse ideas and challenge assumptions"
                }
            },
            {
                id: 14,
                text: "I believe team decisions should be based on",
                options: {
                    a: "The team's mission and goals",
                    b: "A consensus of team members",
                    c: "An open and candid assessment of the issues",
                    d: "The weight of the evidence"
                }
            },
            {
                id: 15,
                text: "Sometimes I",
                options: {
                    a: "See team climate as an end in itself",
                    b: "Play devil's advocate far too long",
                    c: "Fail to see the importance of effective team process",
                    d: "Overemphasize strategic issues and minimize short-term task accomplishments"
                }
            },
            {
                id: 16,
                text: "People have often described me as",
                options: {
                    a: "Independent",
                    b: "Dependable",
                    c: "Imaginative", 
                    d: "Participative"
                }
            },
            {
                id: 17,
                text: "Most of the time I am",
                options: {
                    a: "Responsible and hardworking",
                    b: "Committed and flexible",
                    c: "Enthusiastic and humorous",
                    d: "Honest and authentic"
                }
            },
            {
                id: 18,
                text: "In relating to other team members, at times I get annoyed because they don't",
                options: {
                    a: "Revisit team goals to check progress",
                    b: "See the importance of working well together",
                    c: "Object to team actions with which they disagree",
                    d: "Complete their team assignments on time"
                }
            }
        ];

        // Answer key mapping from Parker Survey
        const answerKey = {
            1: { a: 'contributor', b: 'collaborator', c: 'communicator', d: 'challenger' },
            2: { a: 'collaborator', b: 'communicator', c: 'challenger', d: 'contributor' },
            3: { a: 'communicator', b: 'challenger', c: 'contributor', d: 'collaborator' },
            4: { a: 'challenger', b: 'contributor', c: 'collaborator', d: 'communicator' },
            5: { a: 'contributor', b: 'collaborator', c: 'communicator', d: 'challenger' },
            6: { a: 'contributor', b: 'collaborator', c: 'challenger', d: 'contributor' },
            7: { a: 'communicator', b: 'challenger', c: 'contributor', d: 'collaborator' },
            8: { a: 'challenger', b: 'contributor', c: 'collaborator', d: 'communicator' },
            9: { a: 'contributor', b: 'collaborator', c: 'communicator', d: 'challenger' },
            10: { a: 'collaborator', b: 'communicator', c: 'challenger', d: 'contributor' },
            11: { a: 'communicator', b: 'challenger', c: 'contributor', d: 'collaborator' },
            12: { a: 'challenger', b: 'contributor', c: 'collaborator', d: 'communicator' },
            13: { a: 'contributor', b: 'collaborator', c: 'communicator', d: 'challenger' },
            14: { a: 'collaborator', b: 'communicator', c: 'challenger', d: 'contributor' },
            15: { a: 'communicator', b: 'challenger', c: 'contributor', d: 'collaborator' },
            16: { a: 'challenger', b: 'contributor', c: 'collaborator', d: 'communicator' },
            17: { a: 'contributor', b: 'collaborator', c: 'communicator', d: 'challenger' },
            18: { a: 'collaborator', b: 'communicator', c: 'challenger', d: 'contributor' }
        };

        // Style descriptions
        const styleDescriptions = {
            contributor: {
                title: "Contributor — Task Oriented",
                description: "The Contributor is a task-oriented team member who enjoys providing the team with good technical information and data. You do your 'homework,' push the team to set high performance standards, and use your resources wisely. Most people see you as dependable, although at times you may get bogged down in details or data.",
                strengths: [
                    "Complete all team assignments in a timely and efficient manner",
                    "Freely share all the information and materials you have",
                    "Push the team to set high performance standards", 
                    "Provide technical training for team members",
                    "Can be depended on to do what is asked"
                ],
                weaknesses: [
                    "Go into data overload with reports that are too long",
                    "Push for unrealistic performance standards",
                    "Lose sight of the 'big picture'",
                    "Lack patience with team climate and process issues",
                    "Become impatient with others who don't meet your standards"
                ],
                characteristics: ["Dependable", "Systematic", "Proficient", "Efficient", "Pragmatic"]
            },
            collaborator: {
                title: "Collaborator — Goal Oriented",
                description: "The Collaborator is a goal-directed team member who sees the vision, mission, or goal of the team as paramount. You are flexible and open to new ideas, willing to pitch in and work outside your defined role, and able to share the limelight with other team members. Most people see you as a 'big-picture' person but they believe that at times you may fail to periodically revisit the mission.",
                strengths: [
                    "Help the team establish goals, objectives, and action plans",
                    "Pitch in to help out other members who need help",
                    "Are willing to work outside your defined role to help the team",
                    "Are willing to share the limelight with other team members",
                    "Work hard to achieve team goals even if you don't agree with them"
                ],
                weaknesses: [
                    "Do not give attention to the basic team tasks",
                    "Fail to periodically revisit or challenge the mission or goals",
                    "Do not focus on the individual needs of team members",
                    "Complain about lack of progress toward team goals",
                    "Do not give sufficient attention to the process by which goals are reached"
                ],
                characteristics: ["Forward looking", "Cooperative", "Independent", "Flexible", "Imaginative"]
            },
            communicator: {
                title: "Communicator — Process Oriented",
                description: "The Communicator is a process-oriented team member who is an effective listener. You are a facilitator of involvement, conflict resolution, consensus building, feedback, and the creation of an informal, relaxed climate. Most people see you as a positive person but find that at times you may see process as an end in itself.",
                strengths: [
                    "Help the team relax and have fun by joking, laughing, and discussing personal interests",
                    "Step in to resolve process problems (e.g., conflict, lack of involvement)",
                    "Listen attentively (while withholding judgment) to all viewpoints",
                    "Recognize and praise other team members for their efforts",
                    "Encourage all team members to participate in team discussions and decisions"
                ],
                weaknesses: [
                    "See team process and climate as an end in itself",
                    "Fail to challenge or contradict other team members",
                    "Do not recognize the importance of task accomplishment",
                    "Overuse humor and other process techniques",
                    "Do not give enough emphasis to long-range planning"
                ],
                characteristics: ["Encouraging", "Enthusiastic", "Supportive", "Humorous", "Relaxed"]
            },
            challenger: {
                title: "Challenger — Question Oriented",
                description: "The Challenger is the team member who questions the goals, methods, and even ethics of the team. You are willing to disagree with the leader or higher authority and encourage the team to take well-conceived risks. Most people appreciate the value of your candor and openness, although at times you may not know when to back off an issue.",
                strengths: [
                    "Are willing to disagree with the team leader",
                    "Candidly share your views about the work of the team",
                    "Challenge the team to take well-considered risks",
                    "Push the team to set high ethical standards for their work",
                    "Are willing to back off when your views are not accepted"
                ],
                weaknesses: [
                    "Do not know when to back off",
                    "Push the team to unreasonable risks",
                    "Become rigid and inflexible",
                    "Paint yourself into a corner",
                    "Are too direct in communicating with other team members"
                ],
                characteristics: ["Candid", "Honest", "Principled", "Assertive", "Ethical"]
            }
        };

        // Combination style descriptions
        const combinationStyles = {
            'contributor-collaborator': {
                title: "Contributor and Collaborator",
                description: "You are well focused on both the short-term and long-term aspects of the job. You will do whatever it takes to complete the immediate task and reach the team's overall goals. Such things as sharing your expertise, training, and pitching in and working outside your designated role come naturally to you. You focus on the strategic and tactical issues, which means you may not give sufficient attention to the internal dynamics of the team. You may be so focused on the work that you fail to raise important questions about the team's efforts."
            },
            'contributor-communicator': {
                title: "Contributor and Communicator",
                description: "Some say this is the best of all possible combinations because you emphasize both task and process—getting the job done and how it gets done. You push the team to do excellent work and are able to facilitate a supportive work environment by encouraging involvement, using your listening skills, and resolving differences. At times, however, you may lose sight of the big picture—where your team is going. You may be reluctant to criticize anything about the team for fear of disrupting the positive climate."
            },
            'contributor-challenger': {
                title: "Contributor and Challenger",
                description: "You bring to the team an emphasis on delivering quality work and meeting deadlines combined with an ability to question the team's tasks and process. You push the team to set higher standards, live up to those standards, and periodically question both the standards and the work produced. While you like to get things done, you are willing to consider alternatives when legitimate questions are raised. You may push the team to unrealistic standards and excessive analysis, and fail to see the need to move forward expeditiously toward the long-term goals."
            },
            'collaborator-communicator': {
                title: "Collaborator and Communicator",
                description: "Some people refer to you as a participative visionary because of your emphasis on long-term goals combined with a need to get team members involved in developing and implementing the goals. Your willingness to pitch in and work outside your defined role meshes nicely with the capability to help establish a supportive and positive team climate. At times you may not give sufficient attention to the immediate task or the short-term objectives of the team. You also may not be sufficiently concerned with the need to create a climate that welcomes critical comments about the team's goals and internal dynamics."
            },
            'collaborator-challenger': {
                title: "Collaborator and Challenger",
                description: "You bring to the team a focus on the future and constant reminders to stay on track coupled with a willingness to question the team's purpose, goals, and methods. When necessary, you can be the team's risk taker as you suggest that the team take a hard look at some innovative and far-reaching ideas. However, if you go too far or are too confrontational, you run the risk of being disruptive to the team's dynamics. Your strong emphasis on the future and the big picture may make you impatient with other team members who are concerned with the team's near-term deliverables and the maintenance of a positive climate."
            },
            'communicator-challenger': {
                title: "Communicator and Challenger",
                description: "Your primary contributions are on the process side of the team's success. You ensure that the members work well together while you push the team to address important questions about its strengths and weaknesses. However, you run the risk of seeing process as an end in itself. You need to keep in mind that the team must set long-term goals and work hard to deliver high-quality products and services that satisfy current customer needs."
            }
        };

        // Survey state variables
        let currentQuestion = 0;
        let responses = {};
        let scores = { contributor: 0, collaborator: 0, communicator: 0, challenger: 0 };
        let studentName = '';
        let surveyDate = '';

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date
            document.getElementById('testDate').value = new Date().toISOString().split('T')[0];
            surveyDate = new Date().toLocaleDateString();
        });

        function startSurvey() {
            const nameInput = document.getElementById('studentName');
            const dateInput = document.getElementById('testDate');

            if (!nameInput.value.trim()) {
                alert('Please enter your name before starting the survey.');
                nameInput.focus();
                return;
            }

            if (!dateInput.value) {
                alert('Please select a date.');
                dateInput.focus();
                return;
            }

            studentName = nameInput.value.trim();
            surveyDate = new Date(dateInput.value).toLocaleDateString();

            document.getElementById('intro-section').classList.add('hidden');
            document.getElementById('survey-section').classList.remove('hidden');

            renderQuestion();
        }

        function renderQuestion() {
            const container = document.getElementById('questions-container');
            const question = questions[currentQuestion];

            container.innerHTML = `
                <div class="question-container">
                    <div class="question-header">
                        <div class="question-title">Question ${currentQuestion + 1} of ${questions.length}</div>
                        <div class="question-text">${question.text}</div>
                    </div>
                    <div class="question-content">
                        <div class="ranking-instructions">
                            <p><strong>Click the statements in order of preference:</strong> Click your <span style="color: #27ae60; font-weight: bold;">most applicable</span> choice first, then <span style="color: #3498db; font-weight: bold;">second most</span>, <span style="color: #f39c12; font-weight: bold;">third most</span>, and <span style="color: #e74c3c; font-weight: bold;">least applicable</span> last.</p>
                        </div>
                        <div class="options">
                            ${Object.entries(question.options).map(([key, text]) => `
                                <div class="option" id="option-${question.id}-${key}" onclick="selectOption(${question.id}, '${key}')">
                                    <div class="rank-indicator">
                                        <span class="rank-number">Click to Rank</span>
                                    </div>
                                    <span class="option-text">${key}. ${text}</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="ranking-status">
                            <div class="status-message" id="status-message-${question.id}">
                                Click your most applicable choice first (worth 4 points)
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Load existing responses
            if (responses[question.id]) {
                updateQuestionDisplay(question.id);
            }

            updateProgress();
            updateButtons();
        }

        function selectOption(questionId, optionKey) {
            if (!responses[questionId]) {
                responses[questionId] = {};
            }

            const currentRanking = responses[questionId];
            const optionElement = document.getElementById(`option-${questionId}-${optionKey}`);

            // If option is already ranked, remove its ranking and shift others
            if (currentRanking[optionKey]) {
                const removedRank = currentRanking[optionKey];
                delete currentRanking[optionKey];
                
                // Shift rankings down for options that were ranked after the removed one
                Object.keys(currentRanking).forEach(key => {
                    if (currentRanking[key] > removedRank) {
                        currentRanking[key]--;
                    }
                });
            } else {
                // Assign the next available rank (1, 2, 3, or 4)
                const existingRanks = Object.values(currentRanking).sort((a, b) => a - b);
                const nextRank = existingRanks.length + 1;
                
                if (nextRank <= 4) {
                    currentRanking[optionKey] = nextRank;
                }
            }

            updateQuestionDisplay(questionId);
            updateButtons();
        }

        function updateQuestionDisplay(questionId) {
            const currentRanking = responses[questionId];
            const rankLabels = {
                1: { text: '4 - Most Applicable', class: 'rank-1', color: '#27ae60' },
                2: { text: '3 - Second Most', class: 'rank-2', color: '#3498db' },
                3: { text: '2 - Third Most', class: 'rank-3', color: '#f39c12' },
                4: { text: '1 - Least Applicable', class: 'rank-4', color: '#e74c3c' }
            };

            // Update each option's appearance
            Object.keys(questions[currentQuestion].options).forEach(optionKey => {
                const optionElement = document.getElementById(`option-${questionId}-${optionKey}`);
                const rankIndicator = optionElement.querySelector('.rank-number');
                
                // Remove all existing rank classes
                Object.values(rankLabels).forEach(label => {
                    optionElement.classList.remove(label.class);
                });
                optionElement.classList.remove('selected');

                if (currentRanking[optionKey]) {
                    const rank = currentRanking[optionKey];
                    const label = rankLabels[rank];
                    
                    optionElement.classList.add('selected', label.class);
                    rankIndicator.textContent = label.text;
                } else {
                    rankIndicator.textContent = 'Click to Rank';
                }
            });

            // Update status message
            const statusMessage = document.getElementById(`status-message-${questionId}`);
            const rankedCount = Object.keys(currentRanking).length;
            
            if (rankedCount === 0) {
                statusMessage.textContent = 'Click your most applicable choice first (worth 4 points)';
                statusMessage.style.color = '#7f8c8d';
            } else if (rankedCount < 4) {
                const nextRankText = rankLabels[rankedCount + 1].text;
                statusMessage.textContent = `Next: Click your ${nextRankText}`;
                statusMessage.style.color = rankLabels[rankedCount + 1].color;
                statusMessage.style.fontWeight = 'bold';
            } else {
                statusMessage.textContent = 'All choices ranked! Click any choice to modify your rankings.';
                statusMessage.style.color = '#27ae60';
                statusMessage.style.fontWeight = 'bold';
                
                // Mark question container as complete
                const questionContainer = document.querySelector('.question-container');
                questionContainer.classList.add('complete');
            }
        }

        function validateQuestion(questionId) {
            const response = responses[questionId];
            if (!response) return false;
            
            const values = Object.values(response).filter(v => v !== null && v !== undefined);
            const uniqueValues = [...new Set(values)];
            
            return values.length === 4 && uniqueValues.length === 4 && 
                   uniqueValues.every(v => v >= 1 && v <= 4);
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function updateButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const submitBtn = document.getElementById('submitBtn');

            prevBtn.disabled = currentQuestion === 0;
            
            // Check if current question is complete
            const currentQuestionComplete = validateQuestion(questions[currentQuestion].id);
            
            if (currentQuestion === questions.length - 1) {
                nextBtn.classList.add('hidden');
                submitBtn.classList.remove('hidden');
                
                if (currentQuestionComplete) {
                    submitBtn.textContent = 'Calculate Results';
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('secondary');
                    submitBtn.classList.add('success');
                } else {
                    submitBtn.textContent = 'Complete All Rankings';
                    submitBtn.disabled = true;
                    submitBtn.classList.add('secondary');
                    submitBtn.classList.remove('success');
                }
            } else {
                nextBtn.classList.remove('hidden');
                submitBtn.classList.add('hidden');
                
                if (currentQuestionComplete) {
                    nextBtn.textContent = 'Next →';
                    nextBtn.disabled = false;
                    nextBtn.classList.remove('secondary');
                } else {
                    nextBtn.textContent = 'Complete Rankings to Continue';
                    nextBtn.disabled = true;
                    nextBtn.classList.add('secondary');
                }
            }
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
            }
        }

        function calculateResults() {
            // Validate all questions are complete
            let incompleteQuestions = [];
            for (let i = 1; i <= questions.length; i++) {
                if (!validateQuestion(i)) {
                    incompleteQuestions.push(i);
                }
            }
            
            if (incompleteQuestions.length > 0) {
                alert(`Please complete all rankings for questions: ${incompleteQuestions.join(', ')}`);
                return;
            }

            // Reset scores
            scores = { contributor: 0, collaborator: 0, communicator: 0, challenger: 0 };
            
            // Calculate scores based on responses
            Object.entries(responses).forEach(([questionId, answers]) => {
                Object.entries(answers).forEach(([option, rank]) => {
                    const style = answerKey[parseInt(questionId)][option];
                    // Convert rank to points (rank 1 = 4 points, rank 2 = 3 points, etc.)
                    const points = 5 - rank;
                    scores[style] += points;
                });
            });

            displayResults();
        }

        function displayResults() {
            document.getElementById('survey-section').classList.add('hidden');
            document.getElementById('results').style.display = 'block';
            document.getElementById('downloadSection').classList.remove('hidden');

            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const primaryStyle = sortedScores[0][0];
            const secondaryStyle = sortedScores[1][0];
            
            // Check if there's a clear secondary style (within 3 points of primary)
            const hasSecondaryStyle = sortedScores[0][1] - sortedScores[1][1] <= 3;

            generateResultsContent(primaryStyle, hasSecondaryStyle ? secondaryStyle : null, sortedScores);
            
            // Scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function generateResultsContent(primaryStyle, secondaryStyle, sortedScores) {
            const resultsDiv = document.getElementById('results');
            
            // Primary style description
            const primaryDesc = styleDescriptions[primaryStyle];
            let content = `
                <div class="result-header">
                    <h2>Parker Team Player Survey Results</h2>
                    <div class="result-info">
                        <strong>Name:</strong> ${studentName}<br>
                        <strong>Date:</strong> ${surveyDate}
                    </div>
                </div>

                <div class="score-grid">
                    ${sortedScores.map(([style, score], index) => `
                        <div class="score-card ${index === 0 ? 'primary' : index === 1 && secondaryStyle ? 'secondary' : ''}">
                            <h3>${style.charAt(0).toUpperCase() + style.slice(1)}</h3>
                            <div class="score">${score}</div>
                            <div>${index === 0 ? 'Primary Style' : index === 1 && secondaryStyle ? 'Secondary Style' : ''}</div>
                        </div>
                    `).join('')}
                </div>

                <div class="interpretation">
                    <h3>Your Primary Team Player Style: ${primaryDesc.title}</h3>
                    <div class="style-explanation">
                        <p>${primaryDesc.description}</p>
                        
                        <div class="strengths-weaknesses">
                            <div class="strengths">
                                <h4>Key Strengths - Most of the time you:</h4>
                                <ul>
                                    ${primaryDesc.strengths.map(s => `<li>${s}</li>`).join('')}
                                </ul>
                                <h4 style="margin-top: 20px;">Others usually see you as:</h4>
                                <ul>
                                    ${primaryDesc.characteristics.map(c => `<li>${c}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="weaknesses">
                                <h4>Areas for Development - But sometimes you:</h4>
                                <ul>
                                    ${primaryDesc.weaknesses.map(w => `<li>${w}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>
            `;

            // Add secondary style or combination explanation
            if (secondaryStyle) {
                const comboKey = [primaryStyle, secondaryStyle].sort().join('-');
                const comboDesc = combinationStyles[comboKey];
                
                if (comboDesc) {
                    content += `
                        <h4>Your Combined Style: ${comboDesc.title}</h4>
                        <div class="style-explanation">
                            <p>${comboDesc.description}</p>
                        </div>
                    `;
                } else {
                    const secondaryDesc = styleDescriptions[secondaryStyle];
                    content += `
                        <h4>Your Secondary Style: ${secondaryDesc.title}</h4>
                        <div class="style-explanation">
                            <p>You also demonstrate significant characteristics of the ${secondaryStyle} style. ${secondaryDesc.description}</p>
                        </div>
                    `;
                }
            }

            // Add comprehensive style explanations
            content += `
                <h3 style="margin-top: 40px;">Understanding All Four Team Player Styles</h3>
                <p>While your results show your primary style preferences, understanding all four styles will help you work more effectively with diverse team members and develop your own versatility.</p>
                
                <div class="styles-grid">
                    ${Object.entries(styleDescriptions).map(([styleName, desc]) => `
                        <div class="style-card ${styleName}" style="margin-bottom: 0;">
                            <h4 style="color: ${styleName === 'contributor' ? '#27ae60' : styleName === 'collaborator' ? '#3498db' : styleName === 'communicator' ? '#f39c12' : '#e74c3c'}; margin-bottom: 15px;">
                                ${desc.title}
                            </h4>
                            <p style="margin-bottom: 15px; font-size: 0.95em;">${desc.description}</p>
                            <div style="display: grid; gap: 10px;">
                                <div style="background: rgba(39, 174, 96, 0.1); padding: 10px; border-radius: 6px;">
                                    <strong style="color: #27ae60;">Key Characteristics:</strong><br>
                                    ${desc.characteristics.join(', ')}
                                </div>
                                <div style="background: rgba(231, 76, 60, 0.1); padding: 10px; border-radius: 6px;">
                                    <strong style="color: #e74c3c;">Potential Blind Spots:</strong><br>
                                    ${desc.weaknesses.slice(0, 2).join('; ')}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>

                <h4>Why Mixed Styles Matter</h4>
                <div class="style-explanation">
                    <p>If your scores show a strong secondary style (within 3-5 points of your primary), you have the advantage of flexibility. Mixed styles often make the most effective team players because they can:</p>
                    <ul style="margin: 15px 0; padding-left: 30px;">
                        <li style="margin-bottom: 8px;">Adapt their approach based on team needs</li>
                        <li style="margin-bottom: 8px;">Bridge gaps between different team member styles</li>
                        <li style="margin-bottom: 8px;">Provide balance when their primary style might be overused</li>
                        <li style="margin-bottom: 8px;">Understand and appreciate diverse working preferences</li>
                    </ul>
                    <p>Teams perform best when they have representation from all four styles, creating a balance of task focus, goal orientation, process awareness, and constructive questioning.</p>
                </div>

                <h4>Recommendations for Increasing Your Team Effectiveness</h4>
                <div class="style-explanation">
                    <p><strong>Affirm your strengths.</strong> Acknowledge that your natural style brings value. Look for ways to enhance your strengths. Be the best ${primaryStyle.charAt(0).toUpperCase() + primaryStyle.slice(1)} you can be.</p>
                    
                    <p><strong>Seek complementary team environments.</strong> Look for teams and organizations where your strengths are appreciated and needed. Avoid situations where your natural contributions aren't valued.</p>
                    
                    <p><strong>Develop style flexibility.</strong> ${secondaryStyle ? `Since your secondary style is ${secondaryStyle}, continue developing those skills to increase your versatility.` : 'Consider developing skills from your least developed styles to become more well-rounded.'} Practice adapting your approach when the situation calls for it.</p>
                    
                    <p><strong>Learn to read team needs.</strong> Develop your ability to analyze your team's current situation. When you observe the need for a particular style contribution, provide an appropriate intervention or encourage others to do so.</p>
                    
                    <p><strong>Monitor your style overuse.</strong> Be aware of when your strengths might become weaknesses. Work with colleagues or seek feedback to identify when you're overusing your natural style and what you can do to dial it back.</p>
                    
                    <p><strong>Appreciate other styles.</strong> Recognize that team members with different styles bring valuable perspectives. What might seem like opposing approaches are often complementary contributions to team success.</p>
                </div>

                <h4>Your Complete Score Breakdown</h4>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                    ${sortedScores.map(([style, score], index) => `
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; border-left: 4px solid ${style === 'contributor' ? '#27ae60' : style === 'collaborator' ? '#3498db' : style === 'communicator' ? '#f39c12' : '#e74c3c'};">
                            <strong>${style.charAt(0).toUpperCase() + style.slice(1)}</strong><br>
                            <span style="font-size: 1.5em; font-weight: bold; color: ${style === 'contributor' ? '#27ae60' : style === 'collaborator' ? '#3498db' : style === 'communicator' ? '#f39c12' : '#e74c3c'};">${score}</span><br>
                            <small>${index === 0 ? '(Primary)' : index === 1 && secondaryStyle ? '(Secondary)' : ''}</small>
                        </div>
                    `).join('')}
                </div>
                <p style="margin-top: 15px; font-size: 0.9em; color: #666; text-align: center;"><em>Maximum possible score: 72 points per style (4 points × 18 questions). Your highest score indicates your primary style. Scores within 3-5 points suggest secondary style characteristics.</em></p>
                </div>
            `;

            resultsDiv.innerHTML = content;
        }

        // Enhanced PDF generation with fallback
        function generatePDF() {
            const resultsContent = document.getElementById('results');
            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            
            // Create a simple text-based report as fallback
            let reportText = `PARKER TEAM PLAYER SURVEY RESULTS\n\n`;
            reportText += `Name: ${studentName}\n`;
            reportText += `Date: ${surveyDate}\n\n`;
            reportText += `SCORES:\n`;
            
            sortedScores.forEach(([style, score], index) => {
                reportText += `${style.charAt(0).toUpperCase() + style.slice(1)}: ${score} ${index === 0 ? '(Primary)' : index === 1 ? '(Secondary)' : ''}\n`;
            });
            
            const primaryStyle = sortedScores[0][0];
            const primaryDesc = styleDescriptions[primaryStyle];
            reportText += `\nPRIMARY STYLE: ${primaryDesc.title}\n`;
            reportText += `${primaryDesc.description}\n\n`;
            reportText += `KEY STRENGTHS:\n`;
            primaryDesc.strengths.forEach(strength => {
                reportText += `• ${strength}\n`;
            });
            reportText += `\nAREAS FOR DEVELOPMENT:\n`;
            primaryDesc.weaknesses.forEach(weakness => {
                reportText += `• ${weakness}\n`;
            });

            try {
                // Try to create PDF using browser's built-in capabilities
                const printContent = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Parker Team Player Survey Results - ${studentName}</title>
                        <style>
                            body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; line-height: 1.6; }
                            .header { text-align: center; border-bottom: 3px solid #3498db; padding-bottom: 20px; margin-bottom: 30px; }
                            .score-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0; }
                            .score-card { background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; border-left: 4px solid #3498db; }
                            .strengths-weaknesses { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
                            .strengths, .weaknesses { background: #f8f9fa; padding: 20px; border-radius: 8px; }
                            .strengths { border-left: 4px solid #27ae60; }
                            .weaknesses { border-left: 4px solid #e74c3c; }
                            ul { list-style-type: none; padding-left: 0; }
                            .strengths li::before { content: "✓ "; color: #27ae60; font-weight: bold; }
                            .weaknesses li::before { content: "⚠ "; color: #e74c3c; font-weight: bold; }
                            @media print { body { -webkit-print-color-adjust: exact; } }
                        </style>
                    </head>
                    <body>
                        ${resultsContent.innerHTML}
                    </body>
                    </html>
                `;
                
                const printWindow = window.open('', '_blank');
                printWindow.document.write(printContent);
                printWindow.document.close();
                
                // Wait a moment for content to load, then trigger print dialog
                setTimeout(() => {
                    printWindow.print();
                }, 500);
                
            } catch (error) {
                // Fallback: Create downloadable text file
                const blob = new Blob([reportText], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Parker_Team_Survey_${studentName.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                // Show fallback message
                const fallbackDiv = document.createElement('div');
                fallbackDiv.className = 'pdf-fallback';
                fallbackDiv.innerHTML = `
                    <strong>PDF Download Alternative:</strong> A text file has been downloaded instead. 
                    For a formatted PDF, you can also use your browser's print function (Ctrl+P or Cmd+P) 
                    and select "Save as PDF" as the destination.
                `;
                document.getElementById('downloadSection').appendChild(fallbackDiv);
                setTimeout(() => fallbackDiv.remove(), 10000);
            }
        }

        function openInNewWindow() {
            const resultsContent = document.getElementById('results').innerHTML;
            const newWindow = window.open('', '_blank', 'width=900,height=800,scrollbars=yes,resizable=yes');
            
            const htmlContent = `
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Parker Team Player Survey Results - ${studentName}</title>
                    <style>
                        body {
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                            line-height: 1.6;
                            color: #333;
                            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
                            min-height: 100vh;
                            margin: 0;
                            padding: 20px;
                        }
                        .container {
                            max-width: 900px;
                            margin: 0 auto;
                            background: white;
                            border-radius: 15px;
                            overflow: hidden;
                            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
                        }
                        .results {
                            background: linear-gradient(135deg, #2c3e50, #34495e);
                            color: white;
                        }
                        .result-header {
                            text-align: center;
                            padding: 40px 30px;
                            background: rgba(255,255,255,0.05);
                        }
                        .result-header h2 {
                            font-size: 2.2em;
                            margin-bottom: 15px;
                        }
                        .result-info {
                            background: rgba(255,255,255,0.1);
                            padding: 15px 25px;
                            margin: 20px 0;
                            border-radius: 10px;
                        }
                        .score-grid {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                            gap: 20px;
                            padding: 30px;
                        }
                        .score-card {
                            background: rgba(255,255,255,0.1);
                            padding: 25px;
                            border-radius: 12px;
                            text-align: center;
                        }
                        .score-card.primary {
                            background: linear-gradient(135deg, #f39c12, #e67e22);
                            transform: scale(1.05);
                        }
                        .score-card.secondary {
                            background: linear-gradient(135deg, #3498db, #2980b9);
                        }
                        .score-card h3 {
                            margin-bottom: 10px;
                            font-size: 1.3em;
                        }
                        .score-card .score {
                            font-size: 2.5em;
                            font-weight: bold;
                            margin: 15px 0;
                        }
                        .interpretation {
                            background: white;
                            color: #2c3e50;
                            padding: 40px;
                            line-height: 1.8;
                        }
                        .interpretation h3 {
                            color: #e74c3c;
                            margin-bottom: 20px;
                            font-size: 1.6em;
                        }
                        .interpretation h4 {
                            color: #3498db;
                            margin: 25px 0 15px 0;
                            font-size: 1.3em;
                        }
                        .style-explanation {
                            background: #f8f9fa;
                            padding: 25px;
                            border-radius: 12px;
                            margin: 20px 0;
                            border-left: 4px solid #3498db;
                        }
                        .styles-grid {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                            gap: 20px;
                            margin: 25px 0;
                        }
                        .style-card {
                            background: #f8f9fa;
                            padding: 20px;
                            border-radius: 10px;
                            border-left: 5px solid;
                        }
                        .style-card.contributor { border-left-color: #27ae60; }
                        .style-card.collaborator { border-left-color: #3498db; }
                        .style-card.communicator { border-left-color: #f39c12; }
                        .style-card.challenger { border-left-color: #e74c3c; }
                        .strengths-weaknesses {
                            display: grid;
                            grid-template-columns: 1fr 1fr;
                            gap: 25px;
                            margin: 25px 0;
                        }
                        .strengths, .weaknesses {
                            background: #f8f9fa;
                            padding: 25px;
                            border-radius: 12px;
                        }
                        .strengths {
                            border-left: 4px solid #27ae60;
                        }
                        .weaknesses {
                            border-left: 4px solid #e74c3c;
                        }
                        .strengths ul, .weaknesses ul {
                            list-style-type: none;
                            padding-left: 0;
                        }
                        .strengths li::before {
                            content: "✓";
                            color: #27ae60;
                            font-weight: bold;
                            margin-right: 10px;
                        }
                        .weaknesses li::before {
                            content: "⚠";
                            color: #e74c3c;
                            font-weight: bold;
                            margin-right: 10px;
                        }
                        .print-btn {
                            position: fixed;
                            top: 20px;
                            right: 20px;
                            background: #3498db;
                            color: white;
                            border: none;
                            padding: 12px 24px;
                            border-radius: 25px;
                            cursor: pointer;
                            font-weight: 600;
                            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
                        }
                        .print-btn:hover {
                            background: #2980b9;
                        }
                        @media print {
                            body { background: white !important; }
                            .print-btn { display: none !important; }
                            .container { box-shadow: none !important; }
                        }
                    </style>
                </head>
                <body>
                    <button class="print-btn" onclick="window.print()">Print / Save PDF</button>
                    <div class="container">
                        <div class="results">
                            ${resultsContent}
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            newWindow.document.write(htmlContent);
            newWindow.document.close();
            newWindow.focus();
        }

        function restartSurvey() {
            // Reset all variables
            currentQuestion = 0;
            responses = {};
            scores = { contributor: 0, collaborator: 0, communicator: 0, challenger: 0 };
            studentName = '';
            
            // Reset form
            document.getElementById('studentName').value = '';
            document.getElementById('testDate').value = new Date().toISOString().split('T')[0];
            
            // Show initial section
            document.getElementById('results').style.display = 'none';
            document.getElementById('survey-section').classList.add('hidden');
            document.getElementById('downloadSection').classList.add('hidden');
            document.getElementById('intro-section').classList.remove('hidden');
            
            // Reset progress
            document.getElementById('progressFill').style.width = '0%';
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>